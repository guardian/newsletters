import { sheets_v4 as sheetsV4 } from 'googleapis';
import { prepareRows } from '../googleNewsletterSheets';

describe('prepare rows', () => {
	it('rows', () => {
		const want = [
			[
				'on row 1 and 2',
				'2',
				'3',
				'4',
				'5',
				'6',
				'7',
				'8',
				'9',
				'10',
				'11',
				'12',
				'13',
				'14',
				'15',
				'16',
				'17',
				'18',
				undefined,
			],
			[
				'on row 1 and 2',
				'2',
				'3',
				'4',
				'5',
				'6',
				'7',
				'8',
				'9',
				'10',
				'11',
				'12',
				'13',
				'14',
				'15',
				'16',
				'17',
				'18',
				'not filtered',
			],
			[
				'on row 3 and 4',
				'2',
				'3',
				'4',
				'5',
				'6',
				'7',
				'8',
				'9',
				'10',
				'11',
				'12',
				'13',
				'14',
				'15',
				'16',
				'17',
			],
			[
				'on row 3 and 4',
				'2',
				'3',
				'4',
				'5',
				'6',
				'7',
				'8',
				'9',
				'10',
				'11',
				'12',
				'13',
				'14',
				'15',
				'16',
				'17',
			],
		];
		const rows = [
			[],
			{
				values: [
					{ formattedValue: 'on row 1 and 2' },
					{ formattedValue: '2' },
					{ formattedValue: '3' },
					{ formattedValue: '4' },
					{ formattedValue: '5' },
					{ formattedValue: '6' },
					{ formattedValue: '7' },
					{ formattedValue: '8' },
					{ formattedValue: '9' },
					{ formattedValue: '10' },
					{ formattedValue: '11' },
					{ formattedValue: '12' },
					{ formattedValue: '13' },
					{ formattedValue: '14' },
					{ formattedValue: '15' },
					{ formattedValue: '16' },
					{ formattedValue: '17' },
					{ formattedValue: '18' },
					{
						formattedValue: 'filtered',
						userEnteredFormat: {
							textFormat: { foregroundColor: { red: 1 } },
						},
					},
				],
			} as sheetsV4.Schema$RowData,
			{
				values: [
					{ formattedValue: '' },
					{ formattedValue: '2' },
					{ formattedValue: '3' },
					{ formattedValue: '4' },
					{ formattedValue: '5' },
					{ formattedValue: '6' },
					{ formattedValue: '7' },
					{ formattedValue: '8' },
					{ formattedValue: '9' },
					{ formattedValue: '10' },
					{ formattedValue: '11' },
					{ formattedValue: '12' },
					{ formattedValue: '13' },
					{ formattedValue: '14' },
					{ formattedValue: '15' },
					{ formattedValue: '16' },
					{ formattedValue: '17' },
					{ formattedValue: '18' },
					{
						formattedValue: 'not filtered',
						userEnteredFormat: {
							textFormat: { foregroundColor: { blue: 1 } },
						},
					},
				],
			} as sheetsV4.Schema$RowData,
			{
				values: [
					{ formattedValue: 'on row 3 and 4' },
					{ formattedValue: '2' },
					{ formattedValue: '3' },
					{ formattedValue: '4' },
					{ formattedValue: '5' },
					{ formattedValue: '6' },
					{ formattedValue: '7' },
					{ formattedValue: '8' },
					{ formattedValue: '9' },
					{ formattedValue: '10' },
					{ formattedValue: '11' },
					{ formattedValue: '12' },
					{ formattedValue: '13' },
					{ formattedValue: '14' },
					{ formattedValue: '15' },
					{ formattedValue: '16' },
					{ formattedValue: '17' },
				],
			} as sheetsV4.Schema$RowData,
			{
				values: [
					{ formattedValue: '' },
					{ formattedValue: '2' },
					{ formattedValue: '3' },
					{ formattedValue: '4' },
					{ formattedValue: '5' },
					{ formattedValue: '6' },
					{ formattedValue: '7' },
					{ formattedValue: '8' },
					{ formattedValue: '9' },
					{ formattedValue: '10' },
					{ formattedValue: '11' },
					{ formattedValue: '12' },
					{ formattedValue: '13' },
					{ formattedValue: '14' },
					{ formattedValue: '15' },
					{ formattedValue: '16' },
					{ formattedValue: '17' },
				],
			} as sheetsV4.Schema$RowData,
		] as sheetsV4.Schema$RowData[];
		const got = prepareRows(rows);
		expect(got).toEqual(want);
	});
});
